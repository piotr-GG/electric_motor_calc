from model.flux_density import FluxDensity
import unittest
import numpy as np


class FluxDensityTest(unittest.TestCase):
    def test_sort(self):
        flux_d_input = FluxDensity(np.array([-6, -5, 6, 2, 9, 10, -3]), np.array([1, 2, 3, 4, 5, 6, 7]))
        flux_d_input.sort()

        flux_d_fixture = FluxDensity(np.array([-6, -5, -3, 2, 6, 9, 10]), np.array([1, 2, 7, 4, 3, 5, 6]))
        self.assertTrue(flux_d_input == flux_d_fixture)

    def test_sort_reversed(self):
        flux_d_input = FluxDensity(np.array([-6, -5, 6, 2, 9, 10, -3]), np.array([1, 2, 3, 4, 5, 6, 7]))
        flux_d_input.sort(ascending=False)

        flux_d_fixture = FluxDensity(np.array([10, 9, 6, 2, -3, -5, -6]), np.array([6, 5, 3, 4, 7, 2, 1]))
        self.assertTrue(flux_d_input == flux_d_fixture)

    def test_sort_complex(self):
        orders = np.array(
            [-57, -73, 175, 93, 190, -104, 243, -80, 218, 115, -33, -31, 116, 77, -118, 105, -10, -129, -101, -10, -11,
             244, -85, 116, -61])
        flux_d = np.array([0.0000840096767246428, -0.0000186952984519706, 0.0000280794703293156, 0.0000322195708474659,
                           0.0000223735949745513, 0.0000182626193415207, -0.0000743282650536641, -0.000069198421862015,
                           -0.0000940891504177935, 0.0000876394581188156, 0.0000461364515748679, 6.70633329482955E-06,
                           0.0000647496607154862, -0.0000272447636381964, -0.0000769521903090225, 0.0000610289681511044,
                           4.48647447541771E-06, 0.0000694190436083523, 0.000050871141759775, -0.0000911511067170829,
                           -0.0000936932785069476, -0.0000695634591312659, -0.0000833806426299872,
                           -0.0000980133893282914, 3.81468762620437E-06]
                          )
        flux_d_input = FluxDensity(orders, flux_d)
        flux_d_input.sort()
        orders_fix = np.array(
            [-129, -118, -104, -101, -85, -80, -73, -61, -57, -33, -31, -11, -10, -10, 77, 93, 105, 115, 116, 116, 175,
             190, 218, 243, 244])
        flux_d_fix = np.array(
            [0.0000694190436083523, -0.0000769521903090225, 0.0000182626193415207, 0.000050871141759775,
             -0.0000833806426299872, -0.000069198421862015, -0.0000186952984519706, 3.81468762620437E-06,
             0.0000840096767246428, 0.0000461364515748679, 6.70633329482955E-06, -0.0000936932785069476,
             4.48647447541771E-06, -0.0000911511067170829, -0.0000272447636381964, 0.0000322195708474659,
             0.0000610289681511044, 0.0000876394581188156, 0.0000647496607154862, -0.0000980133893282914,
             0.0000280794703293156, 0.0000223735949745513, -0.0000940891504177935, -0.0000743282650536641,
             -0.0000695634591312659])
        flux_d_fixture = FluxDensity(orders_fix, flux_d_fix)
        self.assertTrue(flux_d_input == flux_d_fixture)

    def test_sort_complex_reversed(self):
        orders = np.array(
            [-57, -73, 175, 93, 190, -104, 243, -80, 218, 115, -33, -31, 116, 77, -118, 105, -10, -129, -101, -10, -11,
             244, -85, 116, -61])
        flux_d = np.array([0.0000840096767246428, -0.0000186952984519706, 0.0000280794703293156, 0.0000322195708474659,
                           0.0000223735949745513, 0.0000182626193415207, -0.0000743282650536641, -0.000069198421862015,
                           -0.0000940891504177935, 0.0000876394581188156, 0.0000461364515748679, 6.70633329482955E-06,
                           0.0000647496607154862, -0.0000272447636381964, -0.0000769521903090225, 0.0000610289681511044,
                           4.48647447541771E-06, 0.0000694190436083523, 0.000050871141759775, -0.0000911511067170829,
                           -0.0000936932785069476, -0.0000695634591312659, -0.0000833806426299872,
                           -0.0000980133893282914, 3.81468762620437E-06]
                          )
        flux_d_input = FluxDensity(orders, flux_d)
        flux_d_input.sort(ascending=False)
        orders_fix = np.array(
            [244, 243, 218, 190, 175, 116, 116, 115, 105, 93, 77, -10, -10, -11, -31, -33, -57, -61, -73, -80, -85,
             -101, -104, -118, -129])
        flux_d_fix = np.array(
            [-0.0000695634591312659, -0.0000743282650536641, -0.0000940891504177935, 0.0000223735949745513,
             0.0000280794703293156, 0.0000647496607154862, -0.0000980133893282914, 0.0000876394581188156,
             0.0000610289681511044, 0.0000322195708474659, -0.0000272447636381964, 4.48647447541771E-06,
             -0.0000911511067170829, -0.0000936932785069476, 6.70633329482955E-06, 0.0000461364515748679,
             0.0000840096767246428, 3.81468762620437E-06, -0.0000186952984519706, -0.000069198421862015,
             -0.0000833806426299872, 0.000050871141759775, 0.0000182626193415207, -0.0000769521903090225,
             0.0000694190436083523])
        flux_d_fixture = FluxDensity(orders_fix, flux_d_fix)
        self.assertTrue(flux_d_input == flux_d_fixture)


if __name__ == "__main__":
    unittest.main()
